"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[6393],{3905:(e,n,t)=>{t.d(n,{Zo:()=>u,kt:()=>d});var r=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function p(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var s=r.createContext({}),c=function(e){var n=r.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},u=function(e){var n=c(e.components);return r.createElement(s.Provider,{value:n},e.children)},i={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,u=p(e,["components","mdxType","originalType","parentName"]),m=c(t),d=a,h=m["".concat(s,".").concat(d)]||m[d]||i[d]||o;return t?r.createElement(h,l(l({ref:n},u),{},{components:t})):r.createElement(h,l({ref:n},u))}));function d(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,l=new Array(o);l[0]=m;var p={};for(var s in n)hasOwnProperty.call(n,s)&&(p[s]=n[s]);p.originalType=e,p.mdxType="string"==typeof e?e:a,l[1]=p;for(var c=2;c<o;c++)l[c]=t[c];return r.createElement.apply(null,l)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},3327:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>l,default:()=>i,frontMatter:()=>o,metadata:()=>p,toc:()=>c});var r=t(7462),a=(t(7294),t(3905));const o={title:"Vue2.7 \u4f7f\u7528 h\u51fd\u6570\u62a5\u9519\u89e3\u51b3\u529e\u6cd5",date:new Date("2024-04-08T23:21:00.000Z"),tags:["Vue"]},l="Vue2.7 \u4f7f\u7528 h\u51fd\u6570\u62a5\u9519\u89e3\u51b3\u529e\u6cd5",p={permalink:"/document/blog/2024/vue2.7 h\u51fd\u6570\u62a5\u9519",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/2024/vue2.7 h\u51fd\u6570\u62a5\u9519.md",source:"@site/blog/2024/vue2.7 h\u51fd\u6570\u62a5\u9519.md",title:"Vue2.7 \u4f7f\u7528 h\u51fd\u6570\u62a5\u9519\u89e3\u51b3\u529e\u6cd5",description:"\u9879\u76ee\u4f7f\u7528 element-ui\uff0c\u4f7f\u7528\u4e86 MessageBox \u5f39\u6846\u7ec4\u4ef6",date:"2024-04-08T23:21:00.000Z",formattedDate:"2024\u5e744\u67088\u65e5",tags:[{label:"Vue",permalink:"/document/blog/tags/vue"}],readingTime:5.265,hasTruncateMarker:!1,authors:[],frontMatter:{title:"Vue2.7 \u4f7f\u7528 h\u51fd\u6570\u62a5\u9519\u89e3\u51b3\u529e\u6cd5",date:"2024-04-08T23:21:00.000Z",tags:["Vue"]},nextItem:{title:"\u4f7f\u7528yalc\u5f00\u53d1npm\u9879\u76ee",permalink:"/document/blog/2023/\u4f7f\u7528yalc\u5f00\u53d1npm\u9879\u76ee"}},s={authorsImageUrls:[]},c=[],u={toc:c};function i(e){let{components:n,...t}=e;return(0,a.kt)("wrapper",(0,r.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"\u9879\u76ee\u4f7f\u7528 element-ui\uff0c\u4f7f\u7528\u4e86 MessageBox \u5f39\u6846\u7ec4\u4ef6"),(0,a.kt)("p",null,"\u7ec4\u4ef6\u7684\u4e00\u4e2a demo \u662f\u8fd9\u6837\u7684\uff0c\u5c31\u662f\u53ef\u4ee5\u901a\u8fc7 vnode\u81ea\u5b9a\u4e49message\u7684\u5185\u5bb9"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"<template>\n  <el-button type=\"text\" @click=\"open\">\u70b9\u51fb\u6253\u5f00 Message Box</el-button>\n</template>\n\n<script>\n  export default {\n    methods: {\n      open() {\n        const h = this.$createElement;\n        this.$msgbox({\n          title: '\u6d88\u606f',\n          message: h('p', null, [\n            h('span', null, '\u5185\u5bb9\u53ef\u4ee5\u662f '),\n            h('i', { style: 'color: teal' }, 'VNode')\n          ]),\n          showCancelButton: true,\n          confirmButtonText: '\u786e\u5b9a',\n          cancelButtonText: '\u53d6\u6d88',\n        })\n      }\n    }\n  }\n<\/script>\n")),(0,a.kt)("p",null,"\u56e0\u4e3a\u9879\u76ee\u5347\u7ea7\u4e86 vue \u7684\u7248\u672c\u4e3a 2.7\uff0c\u6240\u4ee5\u90fd\u4f7f\u7528\u4e86",(0,a.kt)("inlineCode",{parentName:"p"},"setup"),"\u7684\u65b9\u5f0f\u6765\u5199\u4ee3\u7801\u3002\u56e0\u4e3avue 2.7 \u4e2d\u6709\u4e00\u4e2a h \u51fd\u6570\uff0c\u6240\u4ee5\u4e5f\u5c31\u76f4\u63a5 import \u8fdb\u6765\u4f7f\u7528"),(0,a.kt)("p",null,"\u4ee3\u7801\u5927\u6982\u5982\u4e0b"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"import { h } from 'vue'\nimport { MessageBox } from 'element-ui'\n\nconst open = (data) => {\n     MessageBox({\n    message: h('div', null, [\n      h('span', { class: 'color-primary' }, data.name),\n      h('span', null, 'testtesttsert')\n    ]),\n    title: 'xxx',\n    confirmButtonText: '\u786e\u8ba4',\n    cancelButtonText: '\u53d6\u6d88',\n    showCancelButton: true\n  }).then(action => {})\n}\n")),(0,a.kt)("p",null,"\u7136\u800c\u5728\u70b9\u51fb\u6309\u94ae\u6267\u884c ",(0,a.kt)("inlineCode",{parentName:"p"},"open")," \u51fd\u6570\u7684\u65f6\u5019\u62a5\u4e86\u4e00\u4e2a\u9519\u8bef"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"[Vue warn]: globally imported h() can only be invoked when there is an active component instance, e.g. synchronously in a component's render or setup function.")),(0,a.kt)("p",null,"\u5927\u6982\u610f\u601d\u5c31\u662f h \u51fd\u6570\u53ea\u80fd\u5b58\u5728\u6d3b\u52a8\u7ec4\u4ef6\u5b9e\u4f8b\u65f6\u8c03\u7528\uff0c\u4f8b\u5982\u5728\u7ec4\u4ef6\u7684\u6e32\u67d3\u6216\u8bbe\u7f6e\u51fd\u6570\u4e2d\u540c\u6b65\u4f7f\u7528\uff0c\u56e0\u4e3aMessageBox\u5f39\u51fa\u7684\u65f6\u5019\u662f\u65b0\u521b\u5efa\u7684\uff0c\u6240\u4ee5\u5e76\u4e0d\u662f\u5728\u6e32\u67d3\u7684\u65f6\u5019\u6267\u884c\uff0c\u6240\u4ee5\u5c31\u6ca1\u6cd5\u4f7f\u7528 h \u51fd\u6570"),(0,a.kt)("p",null,"\u540e\u9762\u7814\u7a76\u53d1\u73b0\u53ef\u4ee5\u5148\u751f\u6210message\u7684\u5185\u5bb9\uff0c\u518d\u53bb\u6267\u884cMessageBox\u7684\u65b9\u6cd5\u5c31\u53ef\u4ee5\u6b63\u5e38\u4f7f\u7528\uff0c\u4ee3\u7801\u5982\u4e0b"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"import { h } from 'vue'\nimport { MessageBox } from 'element-ui'\nconst content = h('div', null, [\n  h('span', { class: 'color-primary' }, 'xxx'),\n  h('span', null, 'testtesttsert')\n])\nconst open = () => {\n     MessageBox({\n    message: content,\n    title: 'xxx',\n    confirmButtonText: '\u786e\u8ba4',\n    cancelButtonText: '\u53d6\u6d88',\n    showCancelButton: true\n  }).then(action => {})\n}\n")),(0,a.kt)("p",null,"\u8fd9\u4e2a\u65b9\u5f0f\u786e\u5b9e\u4e0d\u62a5\u9519\u4e86\uff0c\u56e0\u4e3a content \u662f\u5728\u6e32\u67d3\u524d\u5c31\u5df2\u7ecf\u751f\u6210\u7684 vnode\uff0c\u6240\u4ee5\u5e76\u4e0d\u4f1a\u6709\u5f71\u54cd"),(0,a.kt)("p",null,"\u4f46\u662f\u5982\u679c\u60f3\u8981\u5728\u70b9\u51fb",(0,a.kt)("inlineCode",{parentName:"p"},"open"),"\u7684\u65f6\u5019\u52a8\u6001\u6539\u53d8",(0,a.kt)("inlineCode",{parentName:"p"},"content "),"\u7684\u5185\u5bb9\u5c31\u4f1a\u56de\u5230\u5f00\u59cb\u9047\u5230\u7684\u95ee\u9898\uff0c\u57fa\u672c\u5c31\u662f\u4e0d\u80fd\u5728\u8fd0\u884c\u65f6\u53bb\u751f\u6210\u8fd9\u4e2a vnode"),(0,a.kt)("p",null,"\u5728\u7f51\u4e0a\u4e5f\u662f\u627e\u4e86\u5f88\u4e45\uff0c\u6ca1\u53d1\u73b0\u6709\u89e3\u51b3\u529e\u6cd5\uff0c\u7136\u540e\u76f4\u63a5\u770b vue \u7684\u6e90\u7801"),(0,a.kt)("p",null,"\u5176\u4e2d h \u51fd\u6570\u7684\u4ee3\u7801\u5c31\u6709\u4e0a\u9762\u90a3\u4e2a\u62a5\u9519\u7684\u539f\u6587\u4e86\uff0c\u5728 vue \u6587\u4ef6\u7684",(0,a.kt)("inlineCode",{parentName:"p"},"/src/v3/h.ts"),"\u91cc\u9762\u6709\u5b8c\u6574\u4ee3\u7801"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},"export function h(type: any, props?: any, children?: any) {\n  if (!currentInstance) {\n    __DEV__ &&\n      warn(\n        `globally imported h() can only be invoked when there is an active ` +\n          `component instance, e.g. synchronously in a component's render or setup function.`\n      )\n  }\n  return createElement(currentInstance!, type, props, children, 2, true)\n}\n")),(0,a.kt)("p",null,"\u8fd9\u91cc\u53d1\u73b0\u4e86\u5b8c\u6574\u7684\u62a5\u9519\u4fe1\u606f\uff0c\u4e5f\u5c31\u662f\u8bf4 h \u51fd\u6570\u627e\u4e0d\u5230\u8fd9\u4e2a",(0,a.kt)("inlineCode",{parentName:"p"},"currentInstance"),"\u5f53\u524d\u7ec4\u4ef6\u7684\u5b9e\u4f8b"),(0,a.kt)("p",null,"\u90a3\u5c31\u5947\u602a\u4e86",(0,a.kt)("inlineCode",{parentName:"p"},"element-plus"),"\u7684",(0,a.kt)("inlineCode",{parentName:"p"},"MessageBox"),"\u7684\u8fd9\u4e2a\u7ec4\u4ef6\u786e\u5b9e\u662f\u76f4\u63a5\u4f7f\u7528\u7684 h \u51fd\u6570\u6765\u6267\u884c\u7684\uff0c\u770b\u6765\u662f vue2.7 \u6709\u4e00\u4e9b\u6ca1\u6709\u517c\u5bb9\u5230\u7684\u5730\u65b9"),(0,a.kt)("p",null,"\u56e0\u4e3aelement-ui\u7684 demo \u4ee3\u7801\u662f\u4f7f\u7528\u4e86",(0,a.kt)("inlineCode",{parentName:"p"},"this.$createElement"),"\u8fd9\u4e2a\u521b\u5efa\u7684 vnode\uff0c\u6240\u4ee5\u53ef\u4ee5\u8bd5\u8bd5\u5728 ",(0,a.kt)("inlineCode",{parentName:"p"},"setup"),"\u7ee7\u7eed\u4f7f\u7528\u8fd9\u4e2a\u51fd\u6570"),(0,a.kt)("p",null,"\u56e0\u4e3a",(0,a.kt)("inlineCode",{parentName:"p"},"setup"),"\u6ca1\u6709\u4e86 ",(0,a.kt)("inlineCode",{parentName:"p"},"this")," \u7684\u7528\u6cd5\u6240\u4ee5\u53ea\u8981\u627e\u5230\u7ec4\u4ef6\u7684\u5b9e\u4f8b\u5c31\u53ef\u4ee5\u7ee7\u7eed\u4f7f\u7528\u8fd9\u4e2a\u65b9\u6cd5\u4e86\uff0c\u5728 vue2.7 \u4e2d\u53ef\u4ee5\u901a\u8fc7",(0,a.kt)("inlineCode",{parentName:"p"},"getCurrentInstance"),"\u8fd9\u4e2a\u62ff\u5230\u5f53\u524d\u7ec4\u4ef6\u7684\u5b9e\u4f8b"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"import { getCurrentInstance } from 'vue'\nconst ctx = getCurrentInstance().proxy\nconst open = (data) => {\n     MessageBox({\n    message: ctx.$createElement('div', null, [\n      ctx.$createElement('span', { class: 'color-primary' }, data.name),\n      ctx.$createElement('span', null, 'testtesttsert')\n    ]),\n    title: 'xxx',\n    confirmButtonText: '\u786e\u8ba4',\n    cancelButtonText: '\u53d6\u6d88',\n    showCancelButton: true\n  }).then(action => {})\n}\n")),(0,a.kt)("p",null,"\u4fee\u6539\u5b8c\u4ee3\u7801\u540e\u6267\u884c\uff0c\u53d1\u73b0\u5b8c\u5168 ok"),(0,a.kt)("p",null,"\u518d\u4f18\u5316\u4e0b\u4ee3\u7801\uff0c\u5c06\u8fd9\u4e2a",(0,a.kt)("inlineCode",{parentName:"p"},"$createElement"),"\u5199\u6210 hook \u7684\u65b9\u5f0f"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"import { getCurrentInstance } from 'vue'\nconst useRender = () => {\n  const ctx = getCurrentInstance().proxy\n  const h = ctx.$createElement\n  return {\n    h\n  }\n}\nexport default useRender\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"import useRender from './useRender'\nconst { h } = useRender()\nconst open = (data) => {\n     MessageBox({\n    message: h('div', null, [\n      h('span', { class: 'color-primary' }, data.name),\n      h('span', null, 'testtesttsert')\n    ]),\n    title: 'xxx',\n    confirmButtonText: '\u786e\u8ba4',\n    cancelButtonText: '\u53d6\u6d88',\n    showCancelButton: true\n  }).then(action => {})\n}\n")),(0,a.kt)("p",null,"\u8fd9\u4e0b\u4ee3\u7801\u66f4\u52a0\u8212\u670d\u53cb\u597d\uff0c\u5b8c\u7f8e\u89e3\u51b3\u4e86h \u51fd\u6570\u7684\u62a5\u9519\u95ee\u9898\u3002"),(0,a.kt)("p",null,"\u56e0\u4e3avue2.7\u6709\u4e86",(0,a.kt)("inlineCode",{parentName:"p"},"Composition API")," \u7684\u5199\u6cd5\uff0c\u5f88\u591a\u6587\u6863\u90fd\u76f4\u63a5\u53bb\u53c2\u8003\u4e86 vue3\u7684\u5730\u65b9\uff0c\u56e0\u4e3a\u4f7f\u7528",(0,a.kt)("inlineCode",{parentName:"p"},"element-ui")," \u6240\u4ee5\u4e5f\u4f1a\u53c2\u8003\u770b",(0,a.kt)("inlineCode",{parentName:"p"},"element-plus"),"\u7684\u6587\u6863\u6765\u770b\u770b vue3\u7684\u5199\u6cd5\uff0c\u4f46\u662f\u8fd9\u91cc\u9762\u6709\u4e9b\u7ec6\u8282\u7684\u5730\u65b9\u8fd8\u662f\u6709\u5f88\u591a\u4e0d\u4e00\u6837\u7684\u3002\u4e0d\u8fc7 vue2.7 \u8fd9\u4e2a",(0,a.kt)("inlineCode",{parentName:"p"},"Composition API"),"\u5199\u6cd5\u8ba9\u4ee3\u7801\u5199\u5f97\u771f\u7684\u975e\u5e38\u8212\u670d\uff0c\u4ee3\u7801\u62d3\u5c55\u6027\u597d\uff0c\u903b\u8f91\u4e5f\u53d8\u5f97\u66f4\u52a0\u6e05\u6670"))}i.isMDXComponent=!0}}]);